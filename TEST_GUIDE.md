# 新功能测试指南

## 已实现功能

### 1️⃣ PDF 缩略图改进

**测试步骤：**
1. 进入包裹编辑页面
2. 在 "Label (Image/PDF)" 部分上传一个 PDF 文件
3. 观察 PDF 缩略图的显示效果

**预期结果：**
- ✅ PDF 显示为红色渐变背景（#f56c6c → #f78989）
- ✅ PDF 图标清晰可见（48px 大小）
- ✅ 鼠标 hover 时图片放大（scale: 1.05）
- ✅ 底部显示文件名

### 2️⃣ 上传 Icon 智能显示控制

**测试场景 1：单张限制（Sender/Receiver/Label）**

1. 在 "Sender Image" 部分上传一张图片
2. 观察上传 Icon 的显示状态

**预期结果：**
- ✅ 第一次上传时显示大型上传 Icon
- ✅ 上传完成后 Icon 消失（单张模式）
- ✅ 删除图片后 Icon 重新出现

**测试场景 2：多张限制（Packing List）**

1. 找到下方的 "Packing List (Multiple Images)" 区域
2. 上传多张图片（最多 10 张）
3. 观察上传进度显示

**预期结果：**
- ✅ 可以连续上传多张图片
- ✅ 显示进度 "3/10"
- ✅ 上传至 10 张后，上传 Icon 消失
- ✅ 删除图片后可继续上传

### 3️⃣ Packing List 多图片上传

**测试步骤：**
1. 滚动到页面下方找到 "Packing List (Multiple Images)" 区域
2. 点击上传 Icon 选择多张图片
3. 一次选择 2-3 个文件上传
4. 观察图片的网格布局和显示

**预期结果：**
- ✅ 支持一次选择多个文件
- ✅ 图片以网格方式显示（120px × 120px）
- ✅ 支持图片和 PDF 混合上传
- ✅ 每个图片下方显示文件名
- ✅ 鼠标 hover 时显示删除按钮（右下角）

## 页面布局

```
┌─────────────────────────────────────────┐
│         Packing List Files              │
├─────────────────────────────────────────┤
│                                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐
│  │ Sender   │  │ Receiver │  │  Label   │
│  │ Image    │  │ Image    │  │ (Img/PDF)│
│  └──────────┘  └──────────┘  └──────────┘
│
│  [第一行：三列布局 - span=8 each]
│
├─────────────────────────────────────────┤
│
│  ┌────────┐ ┌────────┐ ┌────────┐       │
│  │Packing │ │Packing │ │Packing │  +    │
│  │List 1  │ │List 2  │ │List 3  │       │
│  └────────┘ └────────┘ └────────┘       │
│                                         │
│  [第二行：网格布局 - 响应式 columns]     │
│  显示进度：3/10                          │
│
└─────────────────────────────────────────┘
```

## 快速功能测试清单

### Sender Image
- [ ] 能上传图片
- [ ] 只能上传 1 张（再上传被拒绝）
- [ ] 上传后 Icon 消失
- [ ] 删除后 Icon 重新出现

### Receiver Image
- [ ] 能上传图片
- [ ] 只能上传 1 张（再上传被拒绝）
- [ ] 上传后 Icon 消失
- [ ] 删除后 Icon 重新出现

### Label Image/PDF
- [ ] 能上传图片和 PDF
- [ ] 只能上传 1 张
- [ ] PDF 显示红色缩略图
- [ ] PDF 文件名显示正确
- [ ] 上传后 Icon 消失
- [ ] 删除后 Icon 重新出现

### Packing List
- [ ] 能一次上传多张图片
- [ ] 能上传图片和 PDF 混合
- [ ] 支持最多 10 张
- [ ] 显示上传进度（X/10）
- [ ] 达到 10 张后 Icon 消失
- [ ] 图片排列成网格布局
- [ ] 每个图片显示文件名
- [ ] 删除后可继续上传

## 常见测试场景

### 场景 1：编辑现有包裹
1. 点击列表中某个包裹的编辑按钮
2. 如果后端返回了图片数据，应该在对应位置看到已上传的图片
3. 可以继续上传或删除

### 场景 2：创建新包裹
1. 点击 "Add Parcel" 按钮
2. 填写基本信息后，进入图片上传区
3. 应该看到空的上传 Icon

### 场景 3：图片限制测试
1. 尝试上传超过限制的图片数量
2. 应该看到错误提示信息
3. 图片不应该被上传

### 场景 4：文件类型测试
- 上传 JPG/PNG 图片 ✅
- 上传 PDF 文件 ✅
- 尝试上传其他格式（如 .txt）- 应该被 accept 属性过滤

## 浏览器控制台日志

打开 F12 开发者工具，应该能看到以下日志（如果启用了 imageData 传递）：

```javascript
// 编辑时
console.log('提取的后端图片数据:', imageDataFromBackend)
console.log('设置 imageData:', imageData.value)

// ParcelFileUpload 初始化时
initializeImages() 被调用
canAddMoreSender/Receiver/Label/PackingList 被计算
```

## 故障排查

### 问题：页面无法加载
**解决方案：**
- 清除浏览器缓存：Ctrl+Shift+Del
- 强制刷新：Ctrl+Shift+R
- 检查控制台是否有错误

### 问题：上传 Icon 一直显示
**可能原因：**
- `canAddMore*` 计算属性返回值不正确
- `imageTypeConfig` 配置有误

### 问题：PDF 缩略图显示不正常
**可能原因：**
- 文件类型识别错误（检查 `img.type`）
- CSS 被覆盖

### 问题：图片网格显示不正常
**可能原因：**
- CSS Grid 浏览器兼容性问题
- 父容器宽度为 0

## 性能验证

1. **上传速度**
   - 单个 1MB 文件：应在 1-3 秒内完成
   - 批量 10 个文件：应在 10-30 秒内完成

2. **渲染性能**
   - 加载 10 张 Packing List 图片：应流畅无卡顿
   - 滚动编辑对话框：应流畅

3. **内存使用**
   - 编辑对话框打开后，内存不应持续增长
   - 关闭对话框后，内存应释放

## 已知限制

1. **浏览器兼容性**
   - 不支持 IE 11（CSS Grid 等现代特性）
   - 推荐使用 Chrome/Edge/Firefox 最新版

2. **上传限制**
   - Sender/Receiver/Label：最多 1 张
   - Packing List：最多 10 张
   - 这些限制可通过修改 `imageTypeConfig` 调整

3. **文件大小**
   - 建议单个文件 < 5MB
   - 总大小 < 50MB

## 反馈信息

如果发现任何问题，请记录：
- 操作步骤（如何重现）
- 预期结果 vs 实际结果
- 浏览器类型和版本
- 控制台错误信息

---

**测试完成后，项目应该已经完全实现了所有需求功能！** ✨
